<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      UIView Inset Effect &middot; Nate A
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/styles.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-60900610-1', 'auto');
  ga('send', 'pageview');

</script>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          Nate A
        </a>
      </h1>
      <p class="lead">Software Engineer.</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
      
        
          
        
      

      <a class="sidebar-nav-item" href="https://github.com/n8armstrong">GitHub</a>
      <a class="sidebar-nav-item" href="https://twitter.com/N8Armstrong">Twitter</a>
    </nav>

    <p>&copy; 2015. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">UIView Inset Effect</h1>
  <span class="post-date">18 Mar 2015</span>
  <p>I know shadows have been kicked to the curb with iOS 7 but I&#39;m still a sucker for
a nice inset effect.</p>

<h2>The Mockup</h2>

<p>Here is what the design (mocked up in <a href="http://bohemiancoding.com/sketch/">Sketch 3</a>)
called for:</p>

<p><img src='/assets/inset-view/mockup.png' width='350px' /></p>

<p>In the example above the inset view is being used to contain a text field but
as you will see later on the inset will work and look okay with many inner views.</p>

<p>The inset effect view consists of a few attributes:</p>

<ul>
<li>background color that is slightly darker than its surroundings</li>
<li>dark inner shadow</li>
<li>faint outer shadow</li>
</ul>

<p><small>
<i><b>Hint:</b> I&#39;m not a designer but the textured background on the surrounding view
in combination with the solid background of the inner view makes for a nice effect
in my opinion. Also, any and all design tips are welcome in the comments.</i>
</small></p>

<h2>The Implementation</h2>

<p>I will walk you through how I accomplished this effect though I am sure there are
many different ways including superior alternatives.</p>

<h3>Shadows</h3>

<p>A <code>UIView</code> has a <code>layer</code> property which, as a <code>CALayer</code>, provides us with some
helpful properties for applying shadows. Those properties do not help us with
what Sketch would call <em>Inner Shadows</em> so we&#39;ll have to get sneaky for the inner
shadow but the outer shadow will be straightforward.</p>

<h4>Inner Shadow</h4>

<p>I used a <a href="https://github.com/inamiy/YIInnerShadowView">YIInnerShadowView</a> to accomplish
the inner shadow effect with a little bit of tweaking which I will get to in a minute.
I included the class as a pod using cocoapods.</p>

<h4>Outer Shadow</h4>

<p>As I mentioned above the <code>CALayer</code> class has a few properties for applying shadows.
Specifically <code>shadowRadius</code>, <code>shadowColor</code>, <code>shadowOpacity</code> and <code>shadowOffset</code> will
be of great use to us.</p>

<h2>FancyInsetView</h2>

<p>That&#39;s what we&#39;ll call it, <code>FancyInsetView</code>. Assuming you checked out the <code>YIInnerShadowView</code>
class you might think it would be as easy as something like:</p>
<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="c1">// initialize the view using YIInnerShadowView</span>
<span class="k">let</span> <span class="n">myView</span> <span class="o">=</span> <span class="n">YIInnerShadowView</span><span class="p">(</span><span class="nl">frame</span><span class="p">:</span> <span class="n">rect</span><span class="p">)</span>
<span class="n">myView</span><span class="p">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="bp">UIColor</span><span class="p">(</span><span class="nl">red</span><span class="p">:</span> <span class="mi">132</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="nl">green</span><span class="p">:</span> <span class="mi">43</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="nl">blue</span><span class="p">:</span> <span class="mi">10</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="nl">alpha</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="c1">// round the corners</span>
<span class="n">myView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">cornerRadius</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">myView</span><span class="p">.</span><span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">true</span>

<span class="c1">// customize the YIInnerShadow</span>
<span class="n">myView</span><span class="p">.</span><span class="n">shadowRadius</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">myView</span><span class="p">.</span><span class="n">shadowColor</span> <span class="o">=</span> <span class="bp">UIColor</span><span class="p">(</span><span class="nl">white</span><span class="p">:</span> <span class="mi">4</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="nl">alpha</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">myView</span><span class="p">.</span><span class="n">shadowOffset</span> <span class="o">=</span> <span class="n">CGSizeMake</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">myView</span><span class="p">.</span><span class="n">shadowOpacity</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="c1">// give it a faint outer shadow</span>
<span class="n">myView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">masksToBounds</span> <span class="o">=</span> <span class="nb">false</span>
<span class="n">myView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">shadowRadius</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">myView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">shadowColor</span> <span class="o">=</span> <span class="bp">UIColor</span><span class="p">(</span><span class="nl">red</span><span class="p">:</span> <span class="mi">197</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="nl">green</span><span class="p">:</span> <span class="mi">88</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="nl">blue</span><span class="p">:</span> <span class="mi">53</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="nl">alpha</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">).</span><span class="bp">CGColor</span>
<span class="n">myView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">shadowOpacity</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">myView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">shadowOffset</span> <span class="o">=</span> <span class="n">CGSizeMake</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</code></pre></div>
<p>With that most basic approach we end up with:</p>

<p><img src='/assets/inset-view/fail1.png' width='300px' /></p>

<p>Which is close but not quite what we want. If you look closely, the
<code>YIInnerShadowView</code> is creating a dark, thin border around the view and the
corners are not rounded. The reason the corners are not rounded is because of</p>
<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="n">myView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">masksToBounds</span> <span class="o">=</span> <span class="nb">false</span>
</code></pre></div>
<p>Without that line the inner shadow view rounds like we want but the outer shadow
disappears. That is because in order for the outer shadow to show up we must set
<code>layer.masksToBounds</code> to <code>false</code>. So we have a problem.</p>

<h3>The Solution</h3>

<p>We need rounded corners as well as a drop shadow so my solution involves an additional
view nested inside that contains the <code>YIInnerShadowView</code> and the outer view has the
outer shadow properties set.</p>

<p>I made the inner view just a pixel bigger than the container in order to hide the thin border.</p>
<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="k">class</span> <span class="nl">FancyInsetView</span><span class="p">:</span> <span class="bp">UIView</span> <span class="p">{</span>

  <span class="n">lazy</span> <span class="k">var</span> <span class="nl">innerShadow</span><span class="p">:</span> <span class="n">YIInnerShadowView</span> <span class="o">=</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">view</span> <span class="o">=</span> <span class="n">YIInnerShadowView</span><span class="p">(</span><span class="nl">frame</span><span class="p">:</span> <span class="n">CGRectZero</span><span class="p">)</span>
    <span class="n">view</span><span class="p">.</span><span class="n">shadowRadius</span> <span class="o">=</span> <span class="mf">2.0</span>
    <span class="n">view</span><span class="p">.</span><span class="n">shadowColor</span> <span class="o">=</span> <span class="bp">UIColor</span><span class="p">(</span><span class="nl">white</span><span class="p">:</span> <span class="mi">4</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="nl">alpha</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">view</span><span class="p">.</span><span class="n">shadowOffset</span> <span class="o">=</span> <span class="n">CGSizeMake</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">view</span><span class="p">.</span><span class="n">shadowOpacity</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">view</span>
  <span class="p">}()</span>

  <span class="k">var</span> <span class="nl">innerView</span><span class="p">:</span> <span class="bp">UIView</span><span class="o">!</span>

  <span class="k">var</span> <span class="nl">cornerRadius</span><span class="p">:</span> <span class="n">CGFloat</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="p">{</span>
    <span class="kr">didSet</span> <span class="p">{</span>
      <span class="n">layer</span><span class="p">.</span><span class="n">cornerRadius</span> <span class="o">=</span> <span class="n">cornerRadius</span>
      <span class="n">innerView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">cornerRadius</span> <span class="o">=</span> <span class="n">cornerRadius</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">required</span> <span class="k">init</span><span class="p">(</span><span class="n">coder</span> <span class="nl">aDecoder</span><span class="p">:</span> <span class="bp">NSCoder</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">super</span><span class="p">.</span><span class="k">init</span><span class="p">(</span><span class="nl">coder</span><span class="p">:</span> <span class="n">aDecoder</span><span class="p">)</span>
    <span class="n">setup</span><span class="p">()</span>
  <span class="p">}</span>

  <span class="kr">override</span> <span class="k">init</span><span class="p">(</span><span class="nl">frame</span><span class="p">:</span> <span class="bp">CGRect</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">super</span><span class="p">.</span><span class="k">init</span><span class="p">(</span><span class="nl">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
    <span class="n">setup</span><span class="p">()</span>
  <span class="p">}</span>

  <span class="k">func</span> <span class="n">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">backgroundColor</span> <span class="o">=</span> <span class="bp">UIColor</span><span class="p">(</span><span class="nl">red</span><span class="p">:</span> <span class="mi">132</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="nl">green</span><span class="p">:</span> <span class="mi">43</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="nl">blue</span><span class="p">:</span> <span class="mi">10</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="nl">alpha</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">true</span>
    <span class="n">layer</span><span class="p">.</span><span class="n">masksToBounds</span> <span class="o">=</span> <span class="nb">false</span>

    <span class="c1">// inner shadow</span>
    <span class="n">innerView</span> <span class="o">=</span> <span class="bp">UIView</span><span class="p">()</span>
    <span class="n">innerView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">masksToBounds</span> <span class="o">=</span> <span class="nb">true</span>
    <span class="n">innerView</span><span class="p">.</span><span class="n">addSubview</span><span class="p">(</span><span class="n">innerShadow</span><span class="p">)</span>
    <span class="n">insertSubview</span><span class="p">(</span><span class="n">innerView</span><span class="p">,</span> <span class="nl">atIndex</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1">// outer shadow</span>
    <span class="n">layer</span><span class="p">.</span><span class="n">shadowRadius</span> <span class="o">=</span> <span class="mf">2.0</span>
    <span class="n">layer</span><span class="p">.</span><span class="n">shadowColor</span> <span class="o">=</span> <span class="bp">UIColor</span><span class="p">(</span><span class="nl">red</span><span class="p">:</span> <span class="mi">197</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="nl">green</span><span class="p">:</span> <span class="mi">88</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="nl">blue</span><span class="p">:</span> <span class="mi">53</span><span class="o">/</span><span class="mf">255.0</span><span class="p">,</span> <span class="nl">alpha</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">).</span><span class="bp">CGColor</span>
    <span class="n">layer</span><span class="p">.</span><span class="n">shadowOpacity</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">layer</span><span class="p">.</span><span class="n">shadowOffset</span> <span class="o">=</span> <span class="n">CGSizeMake</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="kr">override</span> <span class="k">func</span> <span class="n">layoutSubviews</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">super</span><span class="p">.</span><span class="n">layoutSubviews</span><span class="p">()</span>
    <span class="n">innerView</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">bounds</span>
    <span class="n">innerShadow</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">CGRectInset</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<p>Here&#39;s how it turned out:</p>

<p><img src='/assets/inset-view/success1.png' width='300px' /></p>

<p>That&#39;ll work! Code and demo are <a href="https://github.com/n8armstrong/fancy-inset-view">on GitHub</a>.</p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2015/03/17/hello-world/">
            Hello World
            <small>17 Mar 2015</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

<div class="comments">
  <h2>Comments</h2>
  <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'armstrongnate';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>

    </div>

  </body>
</html>
